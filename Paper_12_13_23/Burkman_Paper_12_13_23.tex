%% 
%% Copyright 2019-2021 Elsevier Ltd
%% 
%% This file is part of the 'CAS Bundle'.
%% --------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'CAS Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for cas-dc documentclass for 
%% double column output.

\documentclass[fleqn]{cas-sc}

\usepackage{lipsum}
\usepackage{tikz}
\usetikzlibrary{shapes, snakes, calc, positioning}
\usepackage{longtable}

% If the frontmatter runs over more than one page
% use the longmktitle option.

%\documentclass[a4paper,fleqn,longmktitle]{cas-dc}

%\usepackage[numbers]{natbib}
%\usepackage[authoryear]{natbib}
\usepackage[authoryear,longnamesfirst]{natbib}

%%%Author macros
\def\tsc#1{\csdef{#1}{\textsc{\lowercase{#1}}\xspace}}
\tsc{WGM}
\tsc{QE}
%%%

% Uncomment and use as if needed
%\newtheorem{theorem}{Theorem}
%\newtheorem{lemma}[theorem]{Lemma}
%\newdefinition{rmk}{Remark}
%\newproof{pf}{Proof}
%\newproof{pot}{Proof of Theorem \ref{thm}}

\begin{document}
\let\WriteBookmarks\relax
\def\floatpagepagefraction{1}
\def\textpagefraction{.001}

% Short title
\shorttitle{Ambulance Dispatch}    

% Short author
\shortauthors{Burkman, Chu, Jin, Abuhijleh, and Sun}  
%\shortauthors{First, Second, Third, Fourth}  

% Main title of the paper
\title [mode = title]{Recommendation System for Ambulance Dispatch based on Automated Crash Reports from Cell Phones}  

% Title footnote mark
% eg: \tnotemark[1]
%\tnotemark[<tnote number>] 
%\tnotemark[1] 

% Title footnote 1.
% eg: \tnotetext[1]{Title footnote text}
%\tnotetext[1]{Working Title} 

% First author
%
% Options: Use if required
% eg: \author[1,3]{Author Name}[type=editor,
%       style=chinese,
%       auid=000,
%       bioid=1,
%       prefix=Sir,
%       orcid=0000-0000-0000-0000,
%       facebook=<facebook id>,
%       twitter=<twitter id>,
%       linkedin=<linkedin id>,
%       gplus=<gplus id>]

%\author[<aff no>]{<author name>}[<options>]
\author[1,2]{J. Bradford Burkman}[]
%\author[1,2]{First Author}[]
% Footnote of the first author
\fnmark[1]
% Corresponding author indication
\cormark[1]
% Email id of the first author
\ead{bradburkman@gmail.com}
%\ead{FirstAuthor@gmail.com}
% URL of the first author
\ead[url]{http://www.github.com/bburkman}

% Credit authorship
% eg: \credit{Conceptualization of this study, Methodology, Software}
% Options: conceptualization; data curation; formal analysis; funding acquisition; investigation; methodology; project administration; resources; software; supervision; validation; visualization; writing – original draft; and writing – review and editing.
\credit{Conceptualization, Investigation, Writing - original draft, Visualization}

\author[1]{Chee-Hung Henry Chu}
\credit{Supervision, Methodology, Writing - review and editing}

\author[1]{Miao Jin}[]
%\author[1]{Second Author}[]
\credit{Supervision, Methodology}

\author[1,3]{Malek Abuhijleh}[]
%\author[1,3]{Third Author}[]
\credit{Data curation, Investigation, Methodology}

\author[3]{Xiaoduan Sun}[]
%\author[3]{Fourth Author}[]
\credit{Data curation, Writing - review and editing}





\affiliation[1]{organization={School of Computing and Informatics, University of Louisiana at Lafayette},
%\affiliation[1]{organization={School, University},
            addressline={301 E. Lewis St}, 
            city={Lafayette},
          citysep={}, % Uncomment if no comma needed between city and postcode
            state={LA},
            postcode={70503}, 
            country={USA}
            }

% Address/affiliation
\affiliation[2]{organization={Louisiana School for Math, Science, and the Arts},
%\affiliation[2]{organization={Other School},
            addressline={715 University Pkwy}, 
            city={Natchitoches},
          citysep={}, % Uncomment if no comma needed between city and postcode
            state={LA},
            postcode={71457}, 
            country={USA}
            }

\affiliation[3]{organization={Department of Civil Engineering, University of Louisiana at Lafayette},
%\affiliation[3]{organization={Other Department, University},
            addressline={131 Rex St}, 
            city={Lafayette},
          citysep={}, % Uncomment if no comma needed between city and postcode
            state={LA},
            postcode={70504}, 
            country={USA}
            }




% For a title note without a number/mark
%\nonumnote{}

% Here goes the abstract
\begin{abstract}
%%%%% Abstract
% I found an abstract in TRpC June 2022 with 365 words.
%Put abstract here.
%%%%% Abstract
% I found an abstract in TRpC June 2022 with 365 words.
Some new cell phones can automatically notify an emergency dispatcher if the phone detects the deceleration profile of a vehicular crash.  Most crash notifications come from an eyewitness who can say whether an ambulance is needed, but the automated notification from the cell phone cannot provide that information directly.  Should the dispatcher immediately send an ambulance before receiving an eyewitness report?  There are three options: Always, Wait, and Sometimes.  The ``Always'' option refers to sending an ambulance to every automatically reported crash, even though most of them will not be needed.  In the ``Wait'' option, the dispatcher sends police, but always waits for a call from an eyewitness (perhaps the police) before sending an ambulance.  In the ``Sometimes'' option, the dispatcher relies on a machine learning recommendation system to decide whether to immediately dispatch an ambulance, reserving the option to send one later based on an eyewitness report.

%This paper explores one option for building a machine learning (ML) model for making a recommendation in the ``Sometimes'' option.  The model gives the probability (based on the available information) that a crash requires an ambulance.  If the probability that an ambulance is needed is above some chosen threshold, the method will recommend dispatching an ambulance immediately; below that threshold, the dispatcher should wait to hear from an eyewitness. 


This paper explores one option for building a machine learning (ML) model for making a recommendation in the ``Sometimes'' option.    Our goal is to build a model that returns, for each feature vector (crash report, sample), a value $p \in [0,1]$ that increases with the probability that the person needs an ambulance.  Then we choose a threshold $\theta$ such that we immediately send ambulances to those automated crash reports with $p > \theta$, and wait for eyewitness confirmation for those reports with $p < \theta$. In an actual implementation, the choice of $\theta$ is political, not technical, so we consider and interpret several options.  

Once a threshold has been chosen, the costs of the false positives (FP) and false negatives (FN) in dispatching ambulances are very different.  The cost of sending an ambulance when one is not needed (FP) is measured in dollars, but the cost of not promptly sending an ambulance when one is needed (FN) is measured in lives.  Choosing the decision threshold $\theta$ is ethically problematic, but governments implicitly choose such a tradeoff when they set budgets for emergency services.  

We consider and interpret several options for the decision threshold $\theta$ based on the political consideration, ``How much will it cost?''  How many automated ambulance dispatches are we willing to fund (FP + TP) for each one of them that is actually needed (TP)?  We will explore two versions of that question, the total and the marginal.  


%some of which consider a relationship between the total number of FP and FN up to that value of $p$, and others consider the marginal relationship around that value of $p$.  Once the threshold criteria are chosen, the problem turns to choosing and tuning a model that best satisfies the tradeoff, saving both money and lives.  

%We consider the factors in determining the threshold.  The costs of the false positives (FP) and false negatives (FN) in dispatching ambulances are very different.  The cost of sending an ambulance when one is not needed (FP) is measured in dollars, but the cost of not promptly sending an ambulance when one is needed (FN) is measured in lives.  Choosing such a tradeoff threshold is ethically problematic, but governments implicitly make such a tradeoff when they set budgets for emergency and medical services.  To demonstrate the method in this paper, we have arbitrarily chosen a cutoff of 33\%, that there is a 1 in 3 chance that a dispatched ambulance would be needed (TP) and a 2 in 3 chance that it would not (FP).  We formulate our marginal ethical tradeoff rate as   $\omega = \Delta FP/\Delta TP = 2.0$.  We incorporated $\omega$ into the model in the class weight and in the decision threshold.  

We show that the quality of the model depends highly on the input data available, and we considered three levels of data availability.  The ``Easy'' level includes data the emergency dispatcher has before the notification, like time of day and weather.  The ``Medium'' level adds information about the location and information from the cell service provider about the user, like the age and sex.  The ``Hard'' level adds information that requires having access to records about the vehicle likely to be driven by the cell phone user and detailed and temporal information about the location, like lighting conditions and whether it is currently a work zone.  

We used the data of the Crash Report Sampling System (CRSS) to validate our approach.  We have applied new methods (for this dataset in the literature) to handle missing data, and we have investigated several methods for handling the data imbalance.  To promote discussion and future research, we have included all of the code we used in our analysis.  
%\vskip 1in

\end{abstract}

% Use if graphical abstract is present
\begin{graphicalabstract}

\tikzstyle{startstop} = [rectangle, rounded corners, 
%minimum width=3cm, 
%minimum height=1cm,
text centered, 
draw=black, 
fill=red!20]

\tikzstyle{io} = [trapezium, 
trapezium stretches=true, % A later addition
trapezium left angle=70, 
trapezium right angle=110, 
%minimum width=3cm, 
%minimum height=1cm, 
text centered, 
draw=black, fill=blue!20]

\tikzstyle{process} = [rectangle, 
%minimum width=3cm, 
%minimum height=1cm, 
text centered, 
%text width=3cm, 
draw=black, 
fill=orange!30]

\tikzstyle{decision} = [diamond, 
%minimum width=3cm, 
%minimum height=1cm, 
text centered, 
aspect=5,
draw=black, 
fill=green!30]

\tikzstyle{arrow} = [thick,->,>=stealth]

\begin{tikzpicture}[x=10mm, y=10mm, node distance = 4mm]
	\clip (0,0) rectangle (13,5);
	\draw (0,0) rectangle (13,5);
	\node (Title) at (6.5,4.6) [align=center, startstop] { \ Recommendation System for Ambulance Dispatch based on Automated Crash Reports \ };
	\node (A) at (3.0,3.7) [io] {Existing Crash Data};
	\node [decision, below= of A] (B) {Choose Features};
	\draw [arrow] (A) -- (B);
	\node [io, below = of B] (D) {\$\$};
	\node [io, left= of D] (C) { \ \ \$ \ \ };
	\node [io, right= of D] (E) {\$\$\$};
	\draw [arrow] (B.south west) -- (C);
	\draw [arrow] (B.south) -- (D);
	\draw [arrow] (B.south east) -- (E);
	\node [process, below = of D] (F) {Build Multiple ML Models};
	\draw [arrow] (C.south) -- ([yshift=-4mm]C.south);
	\draw [arrow] (D.south) -- (F.north);
	\draw [arrow] (E.south) -- ([yshift=-4mm]E.south);
	\node [io, right = 2.5cm of A] (G) {Rankings of Labeled Samples};
	\draw [arrow] (F.east) |- ++(0.9,0) -| ++(0,2) |- (G);
	\node [io, below = of G] (H) {Marginal and Total Results};
	\node [decision, below = of H, align=center] (I) {Political Goals};
	\node [process, below = of I] (J) {Choice of ``Best'' Model};
	\draw [arrow] (G) -- (H);
	\draw [arrow] (H) -- (I);
	\draw [arrow] (I) -- (J);
\end{tikzpicture}
\end{graphicalabstract}

% Research highlights
\begin{highlights}
	\item  Supports transferability and benchmarking of different approaches on a public large-scale dataset.  We have attached the code we used to perform the analysis on data from the Crash Report Sampling System (CRSS).  
	\item Novel Application motivated by Emerging Technology:  Machine Learning Classification Models for Dispatching Ambulances based on Automated Crash Reports
	\item New Use of Dataset:  Used Crash Report Sampling System (CRSS), which has imputed missing values for some features, but not all of the ones we wanted to use.  For the first time we have seen, we used the software the CRSS authors use for multiple imputation (IVEware) to impute missing values in more features, then compared the results with other imputation methods.
	\item Explicit Incorporation of Imbalanced Costs
	\item Explicit Incorporation of Political Dimensions
	\item Consideration of Marginal Effects of Threshold Shifting
	\item Perennial Machine Learning Challenge:  Imbalanced Datasets
\end{highlights}

% Keywords
% Each keyword is seperated by \sep
\begin{keywords}
 \sep Automated crash notification 
 \sep Ambulance dispatch 
 \sep Emergency medical services  
 \sep Machine learning 
 \sep Imbalanced Cost 
 \sep Imbalanced Data 
 \sep Imputation
\end{keywords}

\maketitle

% Main text

%%%%%
%
% To Do
%
%
%%%%%

%\tableofcontents

%%%%% Introduction
\section{Introduction}\label{sec:Introduction}
%%%%%~\nameref{sec:Introduction}
%\input{Introduction}

%%%%% Methods
\section{Methods}\label{sec:Methods}
\input{Methods}
%\section{Methods\_Old}
%\input{Methods_Old}
%\section{Methods\_for\_TRpC}
%\input{Methods_for_TRpC}

%%%%% Results
\section{Results}\label{sec:Results}

%%%%% Conclusions
\section{Conclusions}\label{Conclusions}

%%%%%
\section{Discussion}\label{Discussion}
%\input{Discussion}

%%%%% Future Work
\section{Future Work}\label{FutureWork}
%\input{Future_Work}


%%%%%
\section*{Funding Statement}

This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.

%%%%% Conflict of Interest
\section*{Conflict of Interest}

Declarations of interest: none
%The authors have no relevant financial or non-financial interests to disclose.

%%%%% Acknowledgements
\section*{Acknowledgements}

George Broussard 
%[STUDENT]
contributed to this work in the 
%[FUNDED PROGRAM]
NSF Research Experiences for Undergraduates program.

%%%%% Data Availability
\section*{Data Availability}

The CRSS data is publicly available at 

\url{https://www.nhtsa.gov/crash-data-systems/crash-report-sampling-system}

All of the code and generated data, tables, and graphs are available at 
\url{http://www.github.com/bburkman}

%%%%% Declaration of Generative AI and AI-assisted technologies in the writing process
%\section*{Declaration of Generative AI and AI-assisted technologies in the writing process}



\begin{comment}
% Figure
\begin{figure}[<options>]
	\centering
		\includegraphics[<options>]{}
	  \caption{}\label{fig1}
\end{figure}


\begin{table}[<options>]
\caption{}\label{tbl1}
\begin{tabular*}{\tblwidth}{@{}LL@{}}
\toprule
  &  \\ % Table header row
\midrule
 & \\
 & \\
 & \\
 & \\
\bottomrule
\end{tabular*}
\end{table}
\end{comment}

% Uncomment and use as the case may be
%\begin{theorem} 
%\end{theorem}

% Uncomment and use as the case may be
%\begin{lemma} 
%\end{lemma}

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%\section{}\label{}

% To print the credit authorship contribution details
\printcredits

%% Loading bibliography style file
%\bibliographystyle{model1-num-names}
\bibliographystyle{cas-model2-names}

% Loading bibliography database
\bibliography{Paper_Summer_2022.bib}

\begin{comment}
% Biography
\bio{}
% Here goes the biography details.
\endbio

\bio{pic1}
% Here goes the biography details.
\endbio
\end{comment}

\end{document}

